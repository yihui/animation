


<h1><a name="the_gradient_descent_algorithm" id="the_gradient_descent_algorithm">The Gradient Descent Algorithm</a></h1>
<div class="level1">

<p>

Follow the gradient to the optimum. <img src="/lib/images/smileys/fixme.gif" class="middle" alt="FIXME" />
</p>

</div>
<!-- SECTION "The Gradient Descent Algorithm" [1-89] -->
<h2><a name="animations" id="animations">Animations</a></h2>
<div class="level2">

<p>

<div align="center" class="anidemo" title="Demonstration of the Gradient Descent Algorithm"><fieldset><legend align="center">Demonstration of the Gradient Descent Algorithm</legend><div id="loadinggda" class="loading">loading animation frames... 0%</div><div id="divPreloadgda" class="divPreload"><script language="JavaScript" type="text/javascript">	var sourcegda = "http://animation.r-forge.r-project.org/frames/gradient_descent_algorithm/";	var imgtypegda = "png";	var tmpgda = 0;	var nmaxgda=36; 	var ngda=1;	var tgda;	for(i = 1; i <= nmaxgda; i++){		document.write("<div class=\"divFrame\" id=\"divPreload" + "gda" + i + "\"><img src=\"" + sourcegda + i + "." + imgtypegda + "\"" + " id = \"img" + "gda" + i + "\" onload = \"loading(\'gda\')\" onerror = \"loading(\'gda\')\" alt=\"Demonstration of the Gradient Descent Algorithm\" title=\"Demonstration of the Gradient Descent Algorithm\" /></div>");}</script></div><div class="btncontrol"><input name="nmaxgda" type="hidden" id="nmaxgda" value="36" /><input name="heightgda" type="hidden" id="heightgda" value="500" /><input name="btnPlaygda" type="submit" disabled="disabled" class="anibutton" id="btnPlaygda" title="Play" onclick="playAni('gda')" value="  &gt;  " /> <input name="btnPausegda" type="submit" disabled="disabled" class="anibutton" id="btnPausegda" title="Pause" onclick="pauseAni('gda')" value="  O  " /> <input name="btnFastgda" type="submit" disabled="disabled" class="anibutton" id="btnFastgda" title="Speed up" onclick="fastAni('gda',1)" value="  +  " /> <input name="btnSlowgda" type="submit" disabled="disabled" class="anibutton" id="btnSlowgda" title="Slow down" onclick="fastAni('gda',-1)" value="  -  " /> <input name="btnPrevgda" type="submit" disabled="disabled" class="anibutton" id="btnPrevgda" title="Previous frame" onclick="prevAni('gda',1)" value="  &lt;&lt;  " /> <input name="btnNextgda" type="submit" disabled="disabled" class="anibutton" id="btnNextgda" title="Next frame" onclick="prevAni('gda',-1)" value="  &gt;&gt;  " /> <input name="btnFirstgda" type="submit" disabled="disabled" class="anibutton" id="btnFirstgda" title="First frame" onclick="firstAni('gda',true)" value="  |&lt;  " /> <input name="btnLastgda" type="submit" disabled="disabled" class="anibutton" id="btnLastgda" title="Last frame" onclick="firstAni('gda',false)" value="  &gt;|  " /> <input name="btnMoregda" type="submit" disabled="disabled" class="anibutton" id="btnMoregda" title="More controls" onclick="btnMore('gda')" value="  &lt;&gt;  " /></div><div id="morePargda" class="morepar"><label title="Which frame to go?" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">View frame <input name="txtFramegda" type="text" id="txtFramegda" onblur="txtFrame(this.value, 'gda')" value="1" size="4" class="text" />/36</label> <label title="Loop or not?" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'"><input name="checkLoopgda" type="checkbox" id="checkLoopgda" checked="checked"/>Loop</label> <label title="Time interval for the animation (in sec)" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">Time Interval: <input name="txtIntervalgda" type="text" id="txtIntervalgda" onblur="txtInterval(this)" value="0.3" size="4" class="text" /></label> <label title="Increment in time interval" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">Step: <input name="txtStepgda" type="text" id="txtStepgda" onblur="txtInterval(this)" value="0.1" size="4" class="text" /></label></div><hr /><div class="description">
The arrows will take you to the optimum step by step.
</div></fieldset></div>
</p>

<p>
<div align="center" class="anidemo" title="When Gradient Descent Algorithm Fails"><fieldset><legend align="center">When Gradient Descent Algorithm Fails</legend><div id="loadinggdafail" class="loading">loading animation frames... 0%</div><div id="divPreloadgdafail" class="divPreload"><script language="JavaScript" type="text/javascript">	var sourcegdafail = "http://animation.r-forge.r-project.org/frames/gradient_descent_algorithm_fail/";	var imgtypegdafail = "png";	var tmpgdafail = 0;	var nmaxgdafail=70; 	var ngdafail=1;	var tgdafail;	for(i = 1; i <= nmaxgdafail; i++){		document.write("<div class=\"divFrame\" id=\"divPreload" + "gdafail" + i + "\"><img src=\"" + sourcegdafail + i + "." + imgtypegdafail + "\"" + " id = \"img" + "gdafail" + i + "\" onload = \"loading(\'gdafail\')\" onerror = \"loading(\'gdafail\')\" alt=\"When Gradient Descent Algorithm Fails\" title=\"When Gradient Descent Algorithm Fails\" /></div>");}</script></div><div class="btncontrol"><input name="nmaxgdafail" type="hidden" id="nmaxgdafail" value="70" /><input name="heightgdafail" type="hidden" id="heightgdafail" value="480" /><input name="btnPlaygdafail" type="submit" disabled="disabled" class="anibutton" id="btnPlaygdafail" title="Play" onclick="playAni('gdafail')" value="  &gt;  " /> <input name="btnPausegdafail" type="submit" disabled="disabled" class="anibutton" id="btnPausegdafail" title="Pause" onclick="pauseAni('gdafail')" value="  O  " /> <input name="btnFastgdafail" type="submit" disabled="disabled" class="anibutton" id="btnFastgdafail" title="Speed up" onclick="fastAni('gdafail',1)" value="  +  " /> <input name="btnSlowgdafail" type="submit" disabled="disabled" class="anibutton" id="btnSlowgdafail" title="Slow down" onclick="fastAni('gdafail',-1)" value="  -  " /> <input name="btnPrevgdafail" type="submit" disabled="disabled" class="anibutton" id="btnPrevgdafail" title="Previous frame" onclick="prevAni('gdafail',1)" value="  &lt;&lt;  " /> <input name="btnNextgdafail" type="submit" disabled="disabled" class="anibutton" id="btnNextgdafail" title="Next frame" onclick="prevAni('gdafail',-1)" value="  &gt;&gt;  " /> <input name="btnFirstgdafail" type="submit" disabled="disabled" class="anibutton" id="btnFirstgdafail" title="First frame" onclick="firstAni('gdafail',true)" value="  |&lt;  " /> <input name="btnLastgdafail" type="submit" disabled="disabled" class="anibutton" id="btnLastgdafail" title="Last frame" onclick="firstAni('gdafail',false)" value="  &gt;|  " /> <input name="btnMoregdafail" type="submit" disabled="disabled" class="anibutton" id="btnMoregdafail" title="More controls" onclick="btnMore('gdafail')" value="  &lt;&gt;  " /></div><div id="morePargdafail" class="morepar"><label title="Which frame to go?" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">View frame <input name="txtFramegdafail" type="text" id="txtFramegdafail" onblur="txtFrame(this.value, 'gdafail')" value="1" size="4" class="text" />/70</label> <label title="Loop or not?" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'"><input name="checkLoopgdafail" type="checkbox" id="checkLoopgdafail" checked="checked"/>Loop</label> <label title="Time interval for the animation (in sec)" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">Time Interval: <input name="txtIntervalgdafail" type="text" id="txtIntervalgdafail" onblur="txtInterval(this)" value="0.2" size="4" class="text" /></label> <label title="Increment in time interval" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">Step: <input name="txtStepgdafail" type="text" id="txtStepgdafail" onblur="txtInterval(this)" value="0.1" size="4" class="text" /></label></div><hr /><div class="description">
This example shows how the gradient descent algorithm will fail with a too large step length.
</div></fieldset></div>
</p>

</div>
<!-- SECTION "Animations" [90-570] -->
<h2><a name="r_code" id="r_code">R code</a></h2>
<div class="level2">
<pre class="code r"><a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=library"><span class="kw4">library</span></a><span class="br0">&#40;</span><span class="re5">animation</span><span class="br0">&#41;</span>
<span class="co3"># gradient descent works</span>
<span class="re5">oopt</span> = ani.options<span class="br0">&#40;</span><span class="re4"><span class="re5">ani</span></span><span class="re5">.height</span> = <span class="nu0">500</span>, <span class="re4"><span class="re5">ani</span></span><span class="re5">.width</span> = <span class="nu0">500</span>, <span class="re5">outdir</span> = <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=getwd"><span class="kw4">getwd</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="re5">interval</span> = <span class="nu0">0</span><span class="re5">.<span class="nu0">3</span></span>,
    <span class="re5">nmax</span> = <span class="nu0">50</span>, <span class="re5">title</span> = <span class="st0">"Demonstration of the Gradient Descent Algorithm"</span>,
    <span class="re5">description</span> = <span class="st0">"The arrows will take you to the optimum step by step."</span><span class="br0">&#41;</span>
ani.start<span class="br0">&#40;</span><span class="br0">&#41;</span>
grad.desc<span class="br0">&#40;</span><span class="br0">&#41;</span>
ani.stop<span class="br0">&#40;</span><span class="br0">&#41;</span>
ani.options<span class="br0">&#40;</span><span class="re5">oopt</span><span class="br0">&#41;</span>
&nbsp;
<span class="co3"># gradient descent fails</span>
<span class="re5">oopt</span> = ani.options<span class="br0">&#40;</span><span class="re4"><span class="re5">ani</span></span><span class="re5">.height</span> = <span class="nu0">480</span>, <span class="re4"><span class="re5">ani</span></span><span class="re5">.width</span> = <span class="nu0">480</span>, <span class="re5">outdir</span> = <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=getwd"><span class="kw4">getwd</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="re5">interval</span> = <span class="nu0">0</span><span class="re5">.<span class="nu0">2</span></span>,
    <span class="re5">nmax</span> = <span class="nu0">70</span>, <span class="re5">title</span> = <span class="st0">"When Gradient Descent Algorithm Fails"</span>,
    <span class="re5">description</span> = <span class="st0">"This example shows how the gradient descent algorithm will fail with 
    a too large step length."</span><span class="br0">&#41;</span>
ani.start<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="re5">f2</span> = <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=function"><span class="kw1">function</span></a><span class="br0">&#40;</span><span class="re5">x</span>, <span class="re5">y</span><span class="br0">&#41;</span> <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=sin"><span class="kw4">sin</span></a><span class="br0">&#40;</span><span class="nu0">1</span>/<span class="nu0">2</span> * <span class="re5">x</span>^<span class="nu0">2</span> - <span class="nu0">1</span>/<span class="nu0">4</span> * <span class="re5">y</span>^<span class="nu0">2</span> + <span class="nu0">3</span><span class="br0">&#41;</span> *
    <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=cos"><span class="kw4">cos</span></a><span class="br0">&#40;</span><span class="nu0">2</span> * <span class="re5">x</span> + <span class="nu0">1</span> - <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=exp"><span class="kw4">exp</span></a><span class="br0">&#40;</span><span class="re5">y</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
grad.desc<span class="br0">&#40;</span><span class="re5">f2</span>, <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=c"><span class="kw3">c</span></a><span class="br0">&#40;</span><span class="nu0">-2</span>, <span class="nu0">-2</span>, <span class="nu0">2</span>, <span class="nu0">2</span><span class="br0">&#41;</span>, <a target="_blank"  href="http://wiki.r-project.org/rwiki/rhelp.php?id=c"><span class="kw3">c</span></a><span class="br0">&#40;</span><span class="nu0">-1</span>, <span class="nu0">0</span><span class="re5">.<span class="nu0">5</span></span><span class="br0">&#41;</span>, <span class="re5">gamma</span> = <span class="nu0">0</span><span class="re5">.<span class="nu0">3</span></span>, <span class="re5">tol</span> = 1e<span class="nu0">-04</span><span class="br0">&#41;</span>
ani.stop<span class="br0">&#40;</span><span class="br0">&#41;</span>
ani.options<span class="br0">&#40;</span><span class="re5">oopt</span><span class="br0">&#41;</span></pre>
</div>
<!-- SECTION "R code" [571-] -->